import{e as oe,r as ne,f as ue,p as se,a as re,g as j,m as pe,h as ve,i as _e,u as ce,L as te,j as Ee,k as ge,l as ke,o as ye,q as xe}from"./Basic.b2d38e6d.js";import{d as W,l as H,r as m,A as X,a as s,o as n,c as v,w as e,e as a,v as c,B as G,f as S,g as le,t as J,F as P,u as V,y as ae,h as K,C as ie,j as de,D as me,G as Ce,i as M}from"./index.0afc0801.js";import{l as be}from"./lodash.0535db8c.js";const Ae=["src"],he=K("span",null,null,-1),Ve=W({__name:"Create",props:["modelValue"],emits:["update:modelValue","reload"],setup(O,{emit:C}){const R=O,d=H({get(){return R.modelValue},set(o){C("update:modelValue",o)}}),E=m(),f=X({username:"",password:"",name:"",role:0}),_=X({name:oe,role:ne,username:ue,password:se});function T(){d.value=!1,x(E.value),z.value=!1,B.value=!1,p.value=[]}function U(o){!o||o.validate(l=>{if(l)k();else return re("T\u1EA1o t\xE0i kho\u1EA3n kh\xF4ng th\xE0nh c\xF4ng!"),!1})}const k=()=>{r.value=!0,j(pe,[f.username,f.password,f.name,z.value,f.role,p.value],{done(){d.value=!1,x(E.value),z.value=!1,B.value=!1,p.value=[]},all(){r.value=!1,C("reload")}})},i=m(""),p=m([]),D=m(!1),L=m(),w=o=>{p.value.splice(p.value.indexOf(o),1)},y=()=>{D.value=!0,ie(()=>{L.value.input.focus()})},b=()=>{i.value&&p.value.indexOf(i.value)===-1&&p.value.push(i.value),D.value=!1,i.value=""},z=m(!1),B=m(!1),A=o=>{z.value=o,B.value=URL.createObjectURL(o.raw)},r=m(!1),x=o=>{!o||o.resetFields()};return(o,l)=>{const h=s("el-input"),g=s("el-form-item"),F=s("el-option"),I=s("el-select"),u=s("font-awesome-icon"),$=s("el-avatar"),Q=s("el-upload"),q=s("el-row"),Y=s("el-tag"),N=s("el-button"),Z=s("el-form"),ee=s("el-dialog");return n(),v(ee,{modelValue:V(d),"onUpdate:modelValue":l[11]||(l[11]=t=>ae(d)?d.value=t:null),title:"Th\xEAm ng\u01B0\u1EDDi d\xF9ng m\u1EDBi"},{footer:e(()=>[a(q,{justify:"end"},{default:e(()=>[a(N,{onClick:l[9]||(l[9]=t=>T())},{default:e(()=>[c("H\u1EE7y")]),_:1}),a(N,{type:"primary",onClick:l[10]||(l[10]=t=>U(E.value))},{default:e(()=>[c("T\u1EA1o t\xE0i kho\u1EA3n")]),_:1})]),_:1})]),default:e(()=>[a(Z,{ref_key:"RefFormUserCreate",ref:E,model:f,rules:_},{default:e(()=>[a(g,{label:"T\xE0i kho\u1EA3n",prop:"username"},{default:e(()=>[a(h,{modelValue:f.username,"onUpdate:modelValue":l[0]||(l[0]=t=>f.username=t),onKeyup:l[1]||(l[1]=G(t=>U(E.value),["enter"])),placeholder:"T\xE0i kho\u1EA3n"},null,8,["modelValue"])]),_:1}),a(g,{label:"M\u1EADt kh\u1EA9u",prop:"password"},{default:e(()=>[a(h,{modelValue:f.password,"onUpdate:modelValue":l[2]||(l[2]=t=>f.password=t),onKeyup:l[3]||(l[3]=G(t=>U(E.value),["enter"])),placeholder:"M\u1EADt kh\u1EA9u",type:"password"},null,8,["modelValue"])]),_:1}),a(g,{label:"T\xEAn hi\u1EC3n th\u1ECB",prop:"name"},{default:e(()=>[a(h,{modelValue:f.name,"onUpdate:modelValue":l[4]||(l[4]=t=>f.name=t),onKeyup:l[5]||(l[5]=G(t=>U(E.value),["enter"])),placeholder:"T\xEAn hi\u1EC3n th\u1ECB"},null,8,["modelValue"])]),_:1}),a(g,{label:"Lo\u1EA1i t\xE0i kho\u1EA3n"},{default:e(()=>[a(I,{modelValue:f.role,"onUpdate:modelValue":l[6]||(l[6]=t=>f.role=t),placeholder:"Lo\u1EA1i t\xE0i kho\u1EA3n"},{default:e(()=>[a(F,{label:"Qu\u1EA3n tr\u1ECB vi\xEAn",value:1}),a(F,{label:"C\u1ED9ng t\xE1c vi\xEAn",value:2}),a(F,{label:"Gi\xE1o vi\xEAn ho\u1EB7c \u0111\u1ED1i t\xE1c",value:0})]),_:1},8,["modelValue"])]),_:1}),a(q,null,{default:e(()=>[a(Q,{"auto-upload":!1,onChange:l[7]||(l[7]=t=>{A(t)}),style:{width:"max-content"}},{file:e(({file:t})=>[he]),default:e(()=>[a($,{size:100},{default:e(()=>[B.value?(n(),S("img",{key:0,src:B.value},null,8,Ae)):(n(),v(u,{key:1,icon:["fas","user"],size:"2x"}))]),_:1})]),_:1})]),_:1}),a(q,{class:"mt-2"},{default:e(()=>[(n(!0),S(P,null,le(p.value,t=>(n(),v(Y,{key:t,class:"ml-1",closable:"","disable-transitions":!1,onClose:fe=>w(t)},{default:e(()=>[c(J(t),1)]),_:2},1032,["onClose"]))),128)),D.value?(n(),v(h,{key:0,ref_key:"InputRef",ref:L,modelValue:i.value,"onUpdate:modelValue":l[8]||(l[8]=t=>i.value=t),class:"ml-1 w-20",size:"small",onKeyup:G(b,["enter"]),onBlur:b},null,8,["modelValue","onKeyup"])):(n(),v(N,{key:1,class:"button-new-tag ml-1",size:"small",onClick:y},{default:e(()=>[c(" + New Tag ")]),_:1}))]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}}),we=["src"],Ue=["src"],Fe=K("span",null,null,-1),Re=W({__name:"Edit",props:["modelValue","user"],emits:["update:modelValue","reload"],setup(O,{emit:C}){const R=O,{user:d}=de(R);me(d,o=>{_.username=o.username,_.name=o.name,_.role=o.role,p.value=o.tags,console.log(o)});const E=H({get(){return R.modelValue},set(o){C("update:modelValue",o)}}),f=m(),_=X({username:d==null?void 0:d.value.username,password:"",name:d==null?void 0:d.value.name,role:d==null?void 0:d.value.role}),T=X({name:oe,role:ne,username:ue,password:se.splice(0,1)});function U(o){!o||o.validate(l=>{if(l)k();else return re("T\u1EA1o t\xE0i kho\u1EA3n kh\xF4ng th\xE0nh c\xF4ng!"),!1})}const k=()=>{r.value=!0,j(ve,[d.value.id,_.username,_.password,_.name,z.value,_.role,p.value],{done(){E.value=!1,x(f.value),z.value=!1,B.value=!1,p.value=[]},all(){r.value=!1,C("reload")}})},i=m(""),p=m(d==null?void 0:d.value.tags),D=m(!1),L=m(),w=o=>{p.value.splice(p.value.indexOf(o),1)},y=()=>{D.value=!0,ie(()=>{L.value.input.focus()})},b=()=>{i.value&&p.value.indexOf(i.value)===-1&&p.value.push(i.value),D.value=!1,i.value=""},z=m(!1),B=m(!1),A=o=>{z.value=o,B.value=URL.createObjectURL(o.raw)},r=m(!1),x=o=>{!o||o.resetFields()};return(o,l)=>{const h=s("el-input"),g=s("el-form-item"),F=s("el-option"),I=s("el-select"),u=s("font-awesome-icon"),$=s("el-avatar"),Q=s("el-upload"),q=s("el-row"),Y=s("el-tag"),N=s("el-button"),Z=s("el-form"),ee=s("el-dialog");return n(),v(ee,{modelValue:V(E),"onUpdate:modelValue":l[11]||(l[11]=t=>ae(E)?E.value=t:null),title:`S\u1EEDa th\xF4ng tin ng\u01B0\u1EDDi d\xF9ng: ${V(d).name}`},{footer:e(()=>[a(q,{justify:"end"},{default:e(()=>[a(N,{onClick:l[9]||(l[9]=t=>E.value=!1)},{default:e(()=>[c("H\u1EE7y")]),_:1}),a(N,{type:"primary",onClick:l[10]||(l[10]=t=>U(f.value))},{default:e(()=>[c("C\u1EADp nh\u1EADt")]),_:1})]),_:1})]),default:e(()=>[a(Z,{ref_key:"RefFormUserEdit",ref:f,model:_,rules:T},{default:e(()=>[a(g,{label:"T\xE0i kho\u1EA3n",prop:"username"},{default:e(()=>[a(h,{modelValue:_.username,"onUpdate:modelValue":l[0]||(l[0]=t=>_.username=t),onKeyup:l[1]||(l[1]=G(t=>U(f.value),["enter"])),placeholder:"T\xE0i kho\u1EA3n"},null,8,["modelValue"])]),_:1}),a(g,{label:"M\u1EADt kh\u1EA9u",prop:"password"},{default:e(()=>[a(h,{modelValue:_.password,"onUpdate:modelValue":l[2]||(l[2]=t=>_.password=t),onKeyup:l[3]||(l[3]=G(t=>U(f.value),["enter"])),placeholder:"M\u1EADt kh\u1EA9u \u0111\u1EC3 tr\xF4ng \u0111\u1EC3 kh\xF4ng \u0111\u1ED5i",type:"password"},null,8,["modelValue"])]),_:1}),a(g,{label:"T\xEAn hi\u1EC3n th\u1ECB",prop:"name"},{default:e(()=>[a(h,{modelValue:_.name,"onUpdate:modelValue":l[4]||(l[4]=t=>_.name=t),onKeyup:l[5]||(l[5]=G(t=>U(f.value),["enter"])),placeholder:"T\xEAn hi\u1EC3n th\u1ECB"},null,8,["modelValue"])]),_:1}),a(g,{label:"Lo\u1EA1i t\xE0i kho\u1EA3n"},{default:e(()=>[a(I,{modelValue:_.role,"onUpdate:modelValue":l[6]||(l[6]=t=>_.role=t),placeholder:"Lo\u1EA1i t\xE0i kho\u1EA3n"},{default:e(()=>[a(F,{label:"Qu\u1EA3n tr\u1ECB vi\xEAn",value:1}),a(F,{label:"C\u1ED9ng t\xE1c vi\xEAn",value:2}),a(F,{label:"Gi\xE1o vi\xEAn ho\u1EB7c \u0111\u1ED1i t\xE1c",value:0})]),_:1},8,["modelValue"])]),_:1}),a(q,null,{default:e(()=>[a(Q,{"auto-upload":!1,onChange:l[7]||(l[7]=t=>{A(t)}),style:{width:"max-content"}},{file:e(({file:t})=>[Fe]),default:e(()=>[a($,{size:100},{default:e(()=>[B.value?(n(),S("img",{key:0,src:B.value},null,8,we)):V(d).avatar?(n(),S("img",{key:1,src:V(d).avatar},null,8,Ue)):(n(),v(u,{key:2,icon:["fas","user"],size:"2x"}))]),_:1})]),_:1})]),_:1}),a(q,{class:"mt-2"},{default:e(()=>[(n(!0),S(P,null,le(p.value,t=>(n(),v(Y,{key:t,class:"ml-1",closable:"","disable-transitions":!1,onClose:fe=>w(t)},{default:e(()=>[c(J(t),1)]),_:2},1032,["onClose"]))),128)),D.value?(n(),v(h,{key:0,ref_key:"InputRef",ref:L,modelValue:i.value,"onUpdate:modelValue":l[8]||(l[8]=t=>i.value=t),class:"ml-1 w-20",size:"small",onKeyup:G(b,["enter"]),onBlur:b},null,8,["modelValue","onKeyup"])):(n(),v(N,{key:1,class:"button-new-tag ml-1",size:"small",onClick:y},{default:e(()=>[c(" + New Tag ")]),_:1}))]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),De=W({__name:"Role",props:["modelValue","userId","userRole","listRole"],emits:["update:modelValue","reload"],setup(O,{emit:C}){const R=O,{userRole:d}=de(R),E=H({get(){return R.modelValue},set(k){C("update:modelValue",k)}}),f=m(),_=H(()=>{let k=-1,i={},p={},D=R.listRole.map(w=>{k++;let y={id:k,label:w.label,children:w.children.map(b=>(k++,i[b.id]=k,p[k]=b.id,{id:k,label:b.label}))};return y.children.length===0&&(y.disabled=!0),y}),L=d.value.map(w=>{var y;return(y=i[w])!=null?y:-1}).filter(w=>w!==-1);return{list_role:D,link_role:i,link_session:p,role_default:L}});me(d,()=>{f.value&&f.value.setCheckedKeys(_.value.role_default,!1)});const T=m(!1);function U(){let k=f.value.getCheckedKeys();k=k.map(i=>{var p;return(p=_.value.link_session[i])!=null?p:-1}).filter(i=>i!==-1),T.value=!0,j(_e,[R.userId,k],{done:()=>{E.value=!1},all:()=>{T.value=!1}})}return(k,i)=>{const p=s("el-button"),D=s("el-row"),L=s("el-dialog");return n(),v(L,{modelValue:V(E),"onUpdate:modelValue":i[2]||(i[2]=w=>ae(E)?E.value=w:null),title:"C\u1EA5p quy\u1EC1n ti\u1EBFt h\u1ECDc"},{footer:e(()=>[a(D,{justify:"end"},{default:e(()=>[a(p,{onClick:i[0]||(i[0]=w=>E.value=!1)},{default:e(()=>[c("H\u1EE7y")]),_:1}),a(p,{type:"primary",onClick:i[1]||(i[1]=w=>U()),disabled:T.value,loading:T.value},{default:e(()=>[c("Thay \u0111\u1ED5i")]),_:1},8,["disabled","loading"])]),_:1})]),default:e(()=>[a(V(Ce),{ref_key:"treeRef",ref:f,data:V(_).list_role,"default-checked-keys":V(_).role_default,"show-checkbox":"","default-expand-all":"","node-key":"id","highlight-current":""},null,8,["data","default-checked-keys"])]),_:1},8,["modelValue"])}}}),Be=K("span",null,"Qu\u1EA3n l\xFD t\xE0i kho\u1EA3n ",-1),$e=["src"],Te={key:0},Le=K("h3",null,[K("span",null,"Qu\u1EA3n l\xFD t\xE0i kho\u1EA3n")],-1),ze=K("div",null,[K("p",null,"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp trang n\xE0y")],-1),je=W({__name:"User",setup(O){const C=ce(),R=m(!1),d=m(!1),E=m(!1),f=m({id:0,usename:"",name:"",role:0,tags:[]}),_=m(!1),T=m([]),U=m([]),k=m([]),i=m([]),p=A=>{E.value=!0,f.value=A},D=A=>{j(ge,[A],{all(){y()}})},L=A=>{j(ke,[A],{all(){y()}})},w=A=>{j(ye,[A],{all(){y()}})},y=()=>{R.value=!0,j(Ee,[],{done(A){T.value=[],U.value=[],A.users.map(r=>{var o,l,h,g,F,I,u,$;r.tags&&r.tags.map(Q=>{U.value.indexOf(Q)===-1&&U.value.push(Q)});let x={id:(o=Number(r.id))!=null?o:0,username:(l=String(r.username))!=null?l:"",name:(h=String(r.name))!=null?h:"",avatar:(g=String(r.avatar))!=null?g:"",status:(F=Number(r.status))!=null?F:0,role:(I=Number(r.role))!=null?I:0,is_online:(u=Number(r.is_online))!=null?u:0,tags:($=r.tags)!=null?$:[]};T.value.push(x)})},all(){R.value=!1}})};(C.login&&be.exports.indexOf([1,2],C.info.role))!=-1&&y();const b=m(0),z=m(0);function B(A){b.value=A,z.value=A,j(xe,[A],{done:r=>{let x=[];r.user_role&&r.user_role.map(l=>{x.push(Number(l))}),k.value=x;let o=[];r.list_role&&r.list_role.map(l=>{let h=[];l.sessions&&l.sessions.map(g=>{h.push({id:Number(g.id),label:String(g.name)})}),o.push({label:String(l.name),children:h})}),i.value=o,_.value=!0},all(){b.value=0}})}return(A,r)=>{const x=s("el-button"),o=s("el-row"),l=s("font-awesome-icon"),h=s("el-avatar"),g=s("el-tag"),F=s("el-table-column"),I=s("el-table");return V(C).login&&(V(C).info.role===1||V(C).info.role===2)?(n(),v(te,{key:0},{default:e(()=>[a(o,{align:"middle",justify:"space-between"},{default:e(()=>[K("h3",null,[Be,V(C).info.role===1?(n(),v(x,{key:0,size:"small",type:"primary",onClick:r[0]||(r[0]=u=>d.value=!0)},{default:e(()=>[c(" Th\xEAm t\xE0i kho\u1EA3n ")]),_:1})):M("",!0),a(x,{size:"small",type:"primary",onClick:r[1]||(r[1]=u=>B(0)),disabled:!!b.value,loading:b.value?b.value===0:!1},{default:e(()=>[c(" Gi\xE1o tr\xECnh cho kh\xE1ch ")]),_:1},8,["disabled","loading"])]),a(x,{size:"small",type:"primary",onClick:y,disabled:R.value,loading:R.value},{default:e(()=>[c(" L\xE0m m\u1EDBi ")]),_:1},8,["disabled","loading"])]),_:1}),a(I,{data:T.value,style:{width:"100%"}},{default:e(()=>[a(F,{label:"T\xE0i kho\u1EA3n","table-layout":"auto"},{default:e(u=>[a(o,{align:"middle"},{default:e(()=>[a(h,{size:30,class:"mr-1"},{default:e(()=>[u.row.avatar?(n(),S("img",{key:0,src:u.row.avatar},null,8,$e)):(n(),v(l,{key:1,icon:["fas","user"]}))]),_:2},1024),K("span",null,J(u.row.username),1),u.row.id===V(C).info.id?(n(),S("b",Te," (T\xF4i)")):M("",!0),u.row.role===1?(n(),v(g,{key:1,class:"ml-2",title:"Qu\u1EA3n tr\u1ECB vi\xEAn ho\u1EB7c qu\u1EA3n l\xFD"},{default:e(()=>[c("QTV")]),_:1})):u.row.role===2?(n(),v(g,{key:2,class:"ml-2",title:"C\u1ED9ng t\xE1c vi\xEAn ho\u1EB7c bi\xEAn t\u1EADp vi\xEAn"},{default:e(()=>[c("CTV")]),_:1})):(n(),v(g,{key:3,class:"ml-2",title:"Gi\xE1o vi\xEAn ho\u1EB7c \u0111\u1ED1i t\xE1c"},{default:e(()=>[c("GV")]),_:1})),u.row.status?(n(),v(g,{key:4,class:"ml-2",type:"success"},{default:e(()=>[c("B\xECnh th\u01B0\u1EDDng")]),_:1})):(n(),v(g,{key:5,class:"ml-2",type:"danger"},{default:e(()=>[c("V\xF4 hi\u1EC7u h\xF3a")]),_:1}))]),_:2},1024)]),_:1}),a(F,{label:"H\u1ECD t\xEAn",prop:"name"}),a(F,{label:"Tag"},{default:e(u=>[u.row.tags.length>0?(n(!0),S(P,{key:0},le(u.row.tags,$=>(n(),v(g,{class:"ml-2",type:"info"},{default:e(()=>[c(J($),1)]),_:2},1024))),256)):(n(),v(g,{key:1,class:"ml-2",type:"info"},{default:e(()=>[c("Kh\xF4ng c\xF3 tag")]),_:1}))]),_:1}),a(F,{label:"Ch\u1EE9c n\u0103ng",align:"right"},{default:e(u=>[u.row.role===1?(n(),v(x,{key:0,size:"small",type:"primary",title:"Qu\u1EA3n tr\u1ECB vi\xEAn kh\xF4ng c\u1EA7n \u0111\u1EB7t quy\u1EC1n",disabled:""},{default:e(()=>[c("Gi\xE1o tr\xECnh")]),_:1})):(n(),v(x,{key:1,size:"small",type:"primary",onClick:$=>B(u.row.id),disabled:!!b.value,loading:b.value?b.value===u.row.id:!1},{default:e(()=>[c(" Gi\xE1o tr\xECnh ")]),_:2},1032,["onClick","disabled","loading"])),V(C).info.role===1?(n(),S(P,{key:2},[V(C).info.role===1?(n(),v(x,{key:0,onClick:$=>p(u.row),size:"small"},{default:e(()=>[c(" S\u1EEDa ")]),_:2},1032,["onClick"])):M("",!0),u.row.status?(n(),v(x,{key:1,onClick:$=>w(u.row.id),size:"small",type:"danger"},{default:e(()=>[c(" V\xF4 hi\u1EC7u h\xF3a ")]),_:2},1032,["onClick"])):(n(),v(x,{key:2,onClick:$=>L(u.row.id),size:"small",type:"success"},{default:e(()=>[c(" K\xEDch ho\u1EA1t ")]),_:2},1032,["onClick"])),V(C).info.role===1?(n(),v(x,{key:3,onClick:$=>D(u.row.id),class:"ml-2",size:"small",type:"danger"},{default:e(()=>[c(" X\xF3a ")]),_:2},1032,["onClick"])):M("",!0)],64)):M("",!0)]),_:1})]),_:1},8,["data"]),a(Ve,{modelValue:d.value,"onUpdate:modelValue":r[2]||(r[2]=u=>d.value=u),onReload:y},null,8,["modelValue"]),a(Re,{modelValue:E.value,"onUpdate:modelValue":r[3]||(r[3]=u=>E.value=u),user:f.value,onReload:y},null,8,["modelValue","user"]),a(De,{modelValue:_.value,"onUpdate:modelValue":r[4]||(r[4]=u=>_.value=u),userId:z.value,userRole:k.value,listRole:i.value,onReload:y},null,8,["modelValue","userId","userRole","listRole"])]),_:1})):(n(),v(te,{key:1},{default:e(()=>[a(o,{align:"middle",justify:"space-between"},{default:e(()=>[Le]),_:1}),a(o,null,{default:e(()=>[ze]),_:1})]),_:1}))}}});export{je as default};
