import{a as ae,f as j,m as fe,d as pe,e as ce,u as ve,L as oe,g as Ee,h as ge,i as ke,j as xe,k as ye}from"./Basic.3bc75173.js";import{d as W,v as H,i as m,z as X,o as n,c as p,w as e,a as t,A as N,b as S,h as le,F as J,u as b,x as te,e as K,l as v,B as ne,r as u,f as P,t as ue,C as se,D as he,j as M}from"./index.191eef8f.js";import{n as re,r as ie,u as de,p as me}from"./rules.8fc350db.js";import{l as Ce}from"./lodash.76607b0b.js";const Ae=["src"],be=K("span",null,null,-1),Ve=v(" + New Tag "),we=v("H\u1EE7y"),Ue=v("T\u1EA1o t\xE0i kho\u1EA3n"),Fe=W({__name:"Create",props:["modelValue"],emits:["update:modelValue","reload"],setup(G,{emit:y}){const R=G,i=H({get(){return R.modelValue},set(a){y("update:modelValue",a)}}),E=m(),_=X({username:"",password:"",name:"",role:0}),c=X({name:re,role:ie,username:de,password:me});function B(){i.value=!1,C(E.value),z.value=!1,T.value=!1,f.value=[]}function w(a){!a||a.validate(l=>{if(l)k();else return ae("T\u1EA1o t\xE0i kho\u1EA3n kh\xF4ng th\xE0nh c\xF4ng!"),!1})}const k=()=>{d.value=!0,j(fe,[_.username,_.password,_.name,z.value,_.role,f.value],{done(){i.value=!1,C(E.value),z.value=!1,T.value=!1,f.value=[]},all(){d.value=!1,y("reload")}})},r=m(""),f=m([]),$=m(!1),L=m(),V=a=>{f.value.splice(f.value.indexOf(a),1)},x=()=>{$.value=!0,ne(()=>{L.value.input.focus()})},U=()=>{r.value&&f.value.indexOf(r.value)===-1&&f.value.push(r.value),$.value=!1,r.value=""},z=m(!1),T=m(!1),h=a=>{z.value=a,T.value=URL.createObjectURL(a.raw)},d=m(!1),C=a=>{!a||a.resetFields()};return(a,l)=>{const A=u("el-input"),g=u("el-form-item"),F=u("el-option"),I=u("el-select"),s=u("font-awesome-icon"),D=u("el-avatar"),Q=u("el-upload"),O=u("el-row"),Y=u("el-tag"),q=u("el-button"),Z=u("el-form"),ee=u("el-dialog");return n(),p(ee,{modelValue:b(i),"onUpdate:modelValue":l[11]||(l[11]=o=>te(i)?i.value=o:null),title:"Th\xEAm ng\u01B0\u1EDDi d\xF9ng m\u1EDBi"},{footer:e(()=>[t(O,{justify:"end"},{default:e(()=>[t(q,{onClick:l[9]||(l[9]=o=>B())},{default:e(()=>[we]),_:1}),t(q,{type:"primary",onClick:l[10]||(l[10]=o=>w(E.value))},{default:e(()=>[Ue]),_:1})]),_:1})]),default:e(()=>[t(Z,{ref_key:"RefFormUserCreate",ref:E,model:_,rules:c},{default:e(()=>[t(g,{label:"T\xE0i kho\u1EA3n",prop:"username"},{default:e(()=>[t(A,{modelValue:_.username,"onUpdate:modelValue":l[0]||(l[0]=o=>_.username=o),onKeyup:l[1]||(l[1]=N(o=>w(E.value),["enter"])),placeholder:"T\xE0i kho\u1EA3n"},null,8,["modelValue"])]),_:1}),t(g,{label:"M\u1EADt kh\u1EA9u",prop:"password"},{default:e(()=>[t(A,{modelValue:_.password,"onUpdate:modelValue":l[2]||(l[2]=o=>_.password=o),onKeyup:l[3]||(l[3]=N(o=>w(E.value),["enter"])),placeholder:"M\u1EADt kh\u1EA9u",type:"password"},null,8,["modelValue"])]),_:1}),t(g,{label:"T\xEAn hi\u1EC3n th\u1ECB",prop:"name"},{default:e(()=>[t(A,{modelValue:_.name,"onUpdate:modelValue":l[4]||(l[4]=o=>_.name=o),onKeyup:l[5]||(l[5]=N(o=>w(E.value),["enter"])),placeholder:"T\xEAn hi\u1EC3n th\u1ECB"},null,8,["modelValue"])]),_:1}),t(g,{label:"Lo\u1EA1i t\xE0i kho\u1EA3n"},{default:e(()=>[t(I,{modelValue:_.role,"onUpdate:modelValue":l[6]||(l[6]=o=>_.role=o),placeholder:"Lo\u1EA1i t\xE0i kho\u1EA3n"},{default:e(()=>[t(F,{label:"Qu\u1EA3n tr\u1ECB vi\xEAn",value:1}),t(F,{label:"C\u1ED9ng t\xE1c vi\xEAn",value:2}),t(F,{label:"Gi\xE1o vi\xEAn ho\u1EB7c \u0111\u1ED1i t\xE1c",value:0})]),_:1},8,["modelValue"])]),_:1}),t(O,null,{default:e(()=>[t(Q,{"auto-upload":!1,onChange:l[7]||(l[7]=o=>{h(o)}),style:{width:"max-content"}},{file:e(({file:o})=>[be]),default:e(()=>[t(D,{size:100},{default:e(()=>[T.value?(n(),S("img",{key:0,src:T.value},null,8,Ae)):(n(),p(s,{key:1,icon:["fas","user"],size:"2x"}))]),_:1})]),_:1})]),_:1}),t(O,{class:"mt-2"},{default:e(()=>[(n(!0),S(J,null,le(f.value,o=>(n(),p(Y,{key:o,class:"ml-1",closable:"","disable-transitions":!1,onClose:_e=>V(o)},{default:e(()=>[v(P(o),1)]),_:2},1032,["onClose"]))),128)),$.value?(n(),p(A,{key:0,ref_key:"InputRef",ref:L,modelValue:r.value,"onUpdate:modelValue":l[8]||(l[8]=o=>r.value=o),class:"ml-1 w-20",size:"small",onKeyup:N(U,["enter"]),onBlur:U},null,8,["modelValue","onKeyup"])):(n(),p(q,{key:1,class:"button-new-tag ml-1",size:"small",onClick:x},{default:e(()=>[Ve]),_:1}))]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}}),Re=["src"],$e=["src"],De=K("span",null,null,-1),Be=v(" + New Tag "),Te=v("H\u1EE7y"),Le=v("C\u1EADp nh\u1EADt"),ze=W({__name:"Edit",props:["modelValue","user"],emits:["update:modelValue","reload"],setup(G,{emit:y}){const R=G,{user:i}=ue(R);se(i,a=>{c.username=a.username,c.name=a.name,c.role=a.role,f.value=a.tags,console.log(a)});const E=H({get(){return R.modelValue},set(a){y("update:modelValue",a)}}),_=m(),c=X({username:i==null?void 0:i.value.username,password:"",name:i==null?void 0:i.value.name,role:i==null?void 0:i.value.role}),B=X({name:re,role:ie,username:de,password:me.splice(0,1)});function w(a){!a||a.validate(l=>{if(l)k();else return ae("T\u1EA1o t\xE0i kho\u1EA3n kh\xF4ng th\xE0nh c\xF4ng!"),!1})}const k=()=>{d.value=!0,j(pe,[i.value.id,c.username,c.password,c.name,z.value,c.role,f.value],{done(){E.value=!1,C(_.value),z.value=!1,T.value=!1,f.value=[]},all(){d.value=!1,y("reload")}})},r=m(""),f=m(i==null?void 0:i.value.tags),$=m(!1),L=m(),V=a=>{f.value.splice(f.value.indexOf(a),1)},x=()=>{$.value=!0,ne(()=>{L.value.input.focus()})},U=()=>{r.value&&f.value.indexOf(r.value)===-1&&f.value.push(r.value),$.value=!1,r.value=""},z=m(!1),T=m(!1),h=a=>{z.value=a,T.value=URL.createObjectURL(a.raw)},d=m(!1),C=a=>{!a||a.resetFields()};return(a,l)=>{const A=u("el-input"),g=u("el-form-item"),F=u("el-option"),I=u("el-select"),s=u("font-awesome-icon"),D=u("el-avatar"),Q=u("el-upload"),O=u("el-row"),Y=u("el-tag"),q=u("el-button"),Z=u("el-form"),ee=u("el-dialog");return n(),p(ee,{modelValue:b(E),"onUpdate:modelValue":l[11]||(l[11]=o=>te(E)?E.value=o:null),title:`S\u1EEDa th\xF4ng tin ng\u01B0\u1EDDi d\xF9ng: ${b(i).name}`},{footer:e(()=>[t(O,{justify:"end"},{default:e(()=>[t(q,{onClick:l[9]||(l[9]=o=>E.value=!1)},{default:e(()=>[Te]),_:1}),t(q,{type:"primary",onClick:l[10]||(l[10]=o=>w(_.value))},{default:e(()=>[Le]),_:1})]),_:1})]),default:e(()=>[t(Z,{ref_key:"RefFormUserEdit",ref:_,model:c,rules:B},{default:e(()=>[t(g,{label:"T\xE0i kho\u1EA3n",prop:"username"},{default:e(()=>[t(A,{modelValue:c.username,"onUpdate:modelValue":l[0]||(l[0]=o=>c.username=o),onKeyup:l[1]||(l[1]=N(o=>w(_.value),["enter"])),placeholder:"T\xE0i kho\u1EA3n"},null,8,["modelValue"])]),_:1}),t(g,{label:"M\u1EADt kh\u1EA9u",prop:"password"},{default:e(()=>[t(A,{modelValue:c.password,"onUpdate:modelValue":l[2]||(l[2]=o=>c.password=o),onKeyup:l[3]||(l[3]=N(o=>w(_.value),["enter"])),placeholder:"M\u1EADt kh\u1EA9u \u0111\u1EC3 tr\xF4ng \u0111\u1EC3 kh\xF4ng \u0111\u1ED5i",type:"password"},null,8,["modelValue"])]),_:1}),t(g,{label:"T\xEAn hi\u1EC3n th\u1ECB",prop:"name"},{default:e(()=>[t(A,{modelValue:c.name,"onUpdate:modelValue":l[4]||(l[4]=o=>c.name=o),onKeyup:l[5]||(l[5]=N(o=>w(_.value),["enter"])),placeholder:"T\xEAn hi\u1EC3n th\u1ECB"},null,8,["modelValue"])]),_:1}),t(g,{label:"Lo\u1EA1i t\xE0i kho\u1EA3n"},{default:e(()=>[t(I,{modelValue:c.role,"onUpdate:modelValue":l[6]||(l[6]=o=>c.role=o),placeholder:"Lo\u1EA1i t\xE0i kho\u1EA3n"},{default:e(()=>[t(F,{label:"Qu\u1EA3n tr\u1ECB vi\xEAn",value:1}),t(F,{label:"C\u1ED9ng t\xE1c vi\xEAn",value:2}),t(F,{label:"Gi\xE1o vi\xEAn ho\u1EB7c \u0111\u1ED1i t\xE1c",value:0})]),_:1},8,["modelValue"])]),_:1}),t(O,null,{default:e(()=>[t(Q,{"auto-upload":!1,onChange:l[7]||(l[7]=o=>{h(o)}),style:{width:"max-content"}},{file:e(({file:o})=>[De]),default:e(()=>[t(D,{size:100},{default:e(()=>[T.value?(n(),S("img",{key:0,src:T.value},null,8,Re)):b(i).avatar?(n(),S("img",{key:1,src:b(i).avatar},null,8,$e)):(n(),p(s,{key:2,icon:["fas","user"],size:"2x"}))]),_:1})]),_:1})]),_:1}),t(O,{class:"mt-2"},{default:e(()=>[(n(!0),S(J,null,le(f.value,o=>(n(),p(Y,{key:o,class:"ml-1",closable:"","disable-transitions":!1,onClose:_e=>V(o)},{default:e(()=>[v(P(o),1)]),_:2},1032,["onClose"]))),128)),$.value?(n(),p(A,{key:0,ref_key:"InputRef",ref:L,modelValue:r.value,"onUpdate:modelValue":l[8]||(l[8]=o=>r.value=o),class:"ml-1 w-20",size:"small",onKeyup:N(U,["enter"]),onBlur:U},null,8,["modelValue","onKeyup"])):(n(),p(q,{key:1,class:"button-new-tag ml-1",size:"small",onClick:x},{default:e(()=>[Be]),_:1}))]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),Se=v("H\u1EE7y"),Ke=v("Thay \u0111\u1ED5i"),Ie=W({__name:"Role",props:["modelValue","userId","userRole","listRole"],emits:["update:modelValue","reload"],setup(G,{emit:y}){const R=G,{userRole:i}=ue(R),E=H({get(){return R.modelValue},set(k){y("update:modelValue",k)}}),_=m(),c=H(()=>{let k=-1,r={},f={},$=R.listRole.map(V=>{k++;let x={id:k,label:V.label,children:V.children.map(U=>(k++,r[U.id]=k,f[k]=U.id,{id:k,label:U.label}))};return x.children.length===0&&(x.disabled=!0),x}),L=i.value.map(V=>{var x;return(x=r[V])!=null?x:-1}).filter(V=>V!==-1);return{list_role:$,link_role:r,link_session:f,role_default:L}});se(i,()=>{_.value&&_.value.setCheckedKeys(c.value.role_default,!1)});const B=m(!1);function w(){let k=_.value.getCheckedKeys();k=k.map(r=>{var f;return(f=c.value.link_session[r])!=null?f:-1}).filter(r=>r!==-1),B.value=!0,j(ce,[R.userId,k],{done:()=>{E.value=!1},all:()=>{B.value=!1}})}return(k,r)=>{const f=u("el-button"),$=u("el-row"),L=u("el-dialog");return n(),p(L,{modelValue:b(E),"onUpdate:modelValue":r[2]||(r[2]=V=>te(E)?E.value=V:null),title:"C\u1EA5p quy\u1EC1n ti\u1EBFt h\u1ECDc"},{footer:e(()=>[t($,{justify:"end"},{default:e(()=>[t(f,{onClick:r[0]||(r[0]=V=>E.value=!1)},{default:e(()=>[Se]),_:1}),t(f,{type:"primary",onClick:r[1]||(r[1]=V=>w()),disabled:B.value,loading:B.value},{default:e(()=>[Ke]),_:1},8,["disabled","loading"])]),_:1})]),default:e(()=>[t(b(he),{ref_key:"treeRef",ref:_,data:b(c).list_role,"default-checked-keys":b(c).role_default,"show-checkbox":"","default-expand-all":"","node-key":"id","highlight-current":""},null,8,["data","default-checked-keys"])]),_:1},8,["modelValue"])}}}),je=K("span",null,"Qu\u1EA3n l\xFD t\xE0i kho\u1EA3n ",-1),Ne=v(" Th\xEAm t\xE0i kho\u1EA3n "),Oe=v(" L\xE0m m\u1EDBi "),qe=["src"],Ge={key:0},Qe=v("QTV"),Me=v("CTV"),He=v("GV"),Xe=v("B\xECnh th\u01B0\u1EDDng"),Je=v("V\xF4 hi\u1EC7u h\xF3a"),Pe=v("Kh\xF4ng c\xF3 tag"),We=v("Gi\xE1o tr\xECnh"),Ye=v(" Gi\xE1o tr\xECnh "),Ze=v(" S\u1EEDa "),el=v(" V\xF4 hi\u1EC7u h\xF3a "),ll=v(" K\xEDch ho\u1EA1t "),tl=v(" X\xF3a "),ol=K("h3",null,[K("span",null,"Qu\u1EA3n l\xFD t\xE0i kho\u1EA3n")],-1),al=K("div",null,[K("p",null,"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp trang n\xE0y")],-1),il=W({__name:"User",setup(G){const y=ve(),R=m(!1),i=m(!1),E=m(!1),_=m({id:0,usename:"",name:"",role:0,tags:[]}),c=m(!1),B=m([]),w=m([]),k=m([]),r=m([]),f=h=>{E.value=!0,_.value=h},$=h=>{j(ge,[h],{all(){x()}})},L=h=>{j(ke,[h],{all(){x()}})},V=h=>{j(xe,[h],{all(){x()}})},x=()=>{R.value=!0,j(Ee,[],{done(h){B.value=[],w.value=[],h.users.map(d=>{var a,l,A,g,F,I,s,D;d.tags&&d.tags.map(Q=>{w.value.indexOf(Q)===-1&&w.value.push(Q)});let C={id:(a=Number(d.id))!=null?a:0,username:(l=String(d.username))!=null?l:"",name:(A=String(d.name))!=null?A:"",avatar:(g=String(d.avatar))!=null?g:"",status:(F=Number(d.status))!=null?F:0,role:(I=Number(d.role))!=null?I:0,is_online:(s=Number(d.is_online))!=null?s:0,tags:(D=d.tags)!=null?D:[]};B.value.push(C)})},all(){R.value=!1}})};(y.login&&Ce.exports.indexOf([1,2],y.info.role))!=-1&&x();const U=m(0),z=m(0);function T(h){U.value=h,z.value=h,j(ye,[h],{done:d=>{let C=[];d.user_role&&d.user_role.map(l=>{C.push(Number(l))}),k.value=C;let a=[];d.list_role&&d.list_role.map(l=>{let A=[];l.sessions&&l.sessions.map(g=>{A.push({id:Number(g.id),label:String(g.name)})}),a.push({label:String(l.name),children:A})}),r.value=a,c.value=!0},all(){U.value=0}})}return(h,d)=>{const C=u("el-button"),a=u("el-row"),l=u("font-awesome-icon"),A=u("el-avatar"),g=u("el-tag"),F=u("el-table-column"),I=u("el-table");return b(y).info.role===1||b(y).info.role===2?(n(),p(oe,{key:0},{default:e(()=>[t(a,{align:"middle",justify:"space-between"},{default:e(()=>[K("h3",null,[je,b(y).login&&b(y).info.role===1?(n(),p(C,{key:0,size:"small",type:"primary",onClick:d[0]||(d[0]=s=>i.value=!0)},{default:e(()=>[Ne]),_:1})):M("",!0)]),t(C,{size:"small",type:"primary",onClick:x,disabled:R.value,loading:R.value},{default:e(()=>[Oe]),_:1},8,["disabled","loading"])]),_:1}),t(I,{data:B.value,style:{width:"100%"}},{default:e(()=>[t(F,{label:"T\xE0i kho\u1EA3n","table-layout":"auto"},{default:e(s=>[t(a,{align:"middle"},{default:e(()=>[t(A,{size:30,class:"mr-1"},{default:e(()=>[s.row.avatar?(n(),S("img",{key:0,src:s.row.avatar},null,8,qe)):(n(),p(l,{key:1,icon:["fas","user"]}))]),_:2},1024),K("span",null,P(s.row.username),1),s.row.id===b(y).info.id?(n(),S("b",Ge," (T\xF4i)")):M("",!0),s.row.role===1?(n(),p(g,{key:1,class:"ml-2",title:"Qu\u1EA3n tr\u1ECB vi\xEAn ho\u1EB7c qu\u1EA3n l\xFD"},{default:e(()=>[Qe]),_:1})):s.row.role===2?(n(),p(g,{key:2,class:"ml-2",title:"C\u1ED9ng t\xE1c vi\xEAn ho\u1EB7c bi\xEAn t\u1EADp vi\xEAn"},{default:e(()=>[Me]),_:1})):(n(),p(g,{key:3,class:"ml-2",title:"Gi\xE1o vi\xEAn ho\u1EB7c \u0111\u1ED1i t\xE1c"},{default:e(()=>[He]),_:1})),s.row.status?(n(),p(g,{key:4,class:"ml-2",type:"success"},{default:e(()=>[Xe]),_:1})):(n(),p(g,{key:5,class:"ml-2",type:"danger"},{default:e(()=>[Je]),_:1}))]),_:2},1024)]),_:1}),t(F,{label:"H\u1ECD t\xEAn",prop:"name"}),t(F,{label:"Tag"},{default:e(s=>[s.row.tags.length>0?(n(!0),S(J,{key:0},le(s.row.tags,D=>(n(),p(g,{class:"ml-2",type:"info"},{default:e(()=>[v(P(D),1)]),_:2},1024))),256)):(n(),p(g,{key:1,class:"ml-2",type:"info"},{default:e(()=>[Pe]),_:1}))]),_:1}),t(F,{label:"Ch\u1EE9c n\u0103ng",align:"right"},{default:e(s=>[s.row.role===1?(n(),p(C,{key:0,size:"small",type:"primary",title:"Qu\u1EA3n tr\u1ECB vi\xEAn kh\xF4ng c\u1EA7n \u0111\u1EB7t quy\u1EC1n",disabled:""},{default:e(()=>[We]),_:1})):(n(),p(C,{key:1,size:"small",type:"primary",onClick:D=>T(s.row.id),disabled:!!U.value,loading:U.value?U.value===s.row.id:!1},{default:e(()=>[Ye]),_:2},1032,["onClick","disabled","loading"])),b(y).info.role===1?(n(),S(J,{key:2},[b(y).info.role===1?(n(),p(C,{key:0,onClick:D=>f(s.row),size:"small"},{default:e(()=>[Ze]),_:2},1032,["onClick"])):M("",!0),s.row.status?(n(),p(C,{key:1,onClick:D=>V(s.row.id),size:"small",type:"danger"},{default:e(()=>[el]),_:2},1032,["onClick"])):(n(),p(C,{key:2,onClick:D=>L(s.row.id),size:"small",type:"success"},{default:e(()=>[ll]),_:2},1032,["onClick"])),b(y).info.role===1?(n(),p(C,{key:3,onClick:D=>$(s.row.id),class:"ml-2",size:"small",type:"danger"},{default:e(()=>[tl]),_:2},1032,["onClick"])):M("",!0)],64)):M("",!0)]),_:1})]),_:1},8,["data"]),t(Fe,{modelValue:i.value,"onUpdate:modelValue":d[1]||(d[1]=s=>i.value=s),onReload:x},null,8,["modelValue"]),t(ze,{modelValue:E.value,"onUpdate:modelValue":d[2]||(d[2]=s=>E.value=s),user:_.value,onReload:x},null,8,["modelValue","user"]),t(Ie,{modelValue:c.value,"onUpdate:modelValue":d[3]||(d[3]=s=>c.value=s),userId:z.value,userRole:k.value,listRole:r.value,onReload:x},null,8,["modelValue","userId","userRole","listRole"])]),_:1})):(n(),p(oe,{key:1},{default:e(()=>[t(a,{align:"middle",justify:"space-between"},{default:e(()=>[ol]),_:1}),t(a,null,{default:e(()=>[al]),_:1})]),_:1}))}}});export{il as default};
