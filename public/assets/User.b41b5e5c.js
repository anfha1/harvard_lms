import{a as oe,f as j,m as fe,d as pe,e as ve,u as ce,L as ae,g as Ee,h as ge,i as ke,j as xe,k as ye}from"./Basic.db0fa6f4.js";import{d as W,v as H,i as m,z as X,o as n,c as p,w as e,a as t,A as G,b as S,h as le,F as J,u as V,x as te,e as K,l as c,B as ne,r as s,f as P,t as ue,C as se,D as he,j as M}from"./index.b85b03b1.js";import{n as re,r as ie,u as de,p as me}from"./rules.8fc350db.js";import{l as Ce}from"./lodash.674a1516.js";const be=["src"],Ae=K("span",null,null,-1),Ve=c(" + New Tag "),we=c("H\u1EE7y"),Ue=c("T\u1EA1o t\xE0i kho\u1EA3n"),Fe=W({__name:"Create",props:["modelValue"],emits:["update:modelValue","reload"],setup(q,{emit:h}){const R=q,d=H({get(){return R.modelValue},set(o){h("update:modelValue",o)}}),E=m(),_=X({username:"",password:"",name:"",role:0}),v=X({name:re,role:ie,username:de,password:me});function T(){d.value=!1,y(E.value),L.value=!1,D.value=!1,f.value=[]}function U(o){!o||o.validate(l=>{if(l)k();else return oe("T\u1EA1o t\xE0i kho\u1EA3n kh\xF4ng th\xE0nh c\xF4ng!"),!1})}const k=()=>{r.value=!0,j(fe,[_.username,_.password,_.name,L.value,_.role,f.value],{done(){d.value=!1,y(E.value),L.value=!1,D.value=!1,f.value=[]},all(){r.value=!1,h("reload")}})},i=m(""),f=m([]),$=m(!1),z=m(),w=o=>{f.value.splice(f.value.indexOf(o),1)},x=()=>{$.value=!0,ne(()=>{z.value.input.focus()})},C=()=>{i.value&&f.value.indexOf(i.value)===-1&&f.value.push(i.value),$.value=!1,i.value=""},L=m(!1),D=m(!1),b=o=>{L.value=o,D.value=URL.createObjectURL(o.raw)},r=m(!1),y=o=>{!o||o.resetFields()};return(o,l)=>{const A=s("el-input"),g=s("el-form-item"),F=s("el-option"),I=s("el-select"),u=s("font-awesome-icon"),B=s("el-avatar"),Q=s("el-upload"),N=s("el-row"),Y=s("el-tag"),O=s("el-button"),Z=s("el-form"),ee=s("el-dialog");return n(),p(ee,{modelValue:V(d),"onUpdate:modelValue":l[11]||(l[11]=a=>te(d)?d.value=a:null),title:"Th\xEAm ng\u01B0\u1EDDi d\xF9ng m\u1EDBi"},{footer:e(()=>[t(N,{justify:"end"},{default:e(()=>[t(O,{onClick:l[9]||(l[9]=a=>T())},{default:e(()=>[we]),_:1}),t(O,{type:"primary",onClick:l[10]||(l[10]=a=>U(E.value))},{default:e(()=>[Ue]),_:1})]),_:1})]),default:e(()=>[t(Z,{ref_key:"RefFormUserCreate",ref:E,model:_,rules:v},{default:e(()=>[t(g,{label:"T\xE0i kho\u1EA3n",prop:"username"},{default:e(()=>[t(A,{modelValue:_.username,"onUpdate:modelValue":l[0]||(l[0]=a=>_.username=a),onKeyup:l[1]||(l[1]=G(a=>U(E.value),["enter"])),placeholder:"T\xE0i kho\u1EA3n"},null,8,["modelValue"])]),_:1}),t(g,{label:"M\u1EADt kh\u1EA9u",prop:"password"},{default:e(()=>[t(A,{modelValue:_.password,"onUpdate:modelValue":l[2]||(l[2]=a=>_.password=a),onKeyup:l[3]||(l[3]=G(a=>U(E.value),["enter"])),placeholder:"M\u1EADt kh\u1EA9u",type:"password"},null,8,["modelValue"])]),_:1}),t(g,{label:"T\xEAn hi\u1EC3n th\u1ECB",prop:"name"},{default:e(()=>[t(A,{modelValue:_.name,"onUpdate:modelValue":l[4]||(l[4]=a=>_.name=a),onKeyup:l[5]||(l[5]=G(a=>U(E.value),["enter"])),placeholder:"T\xEAn hi\u1EC3n th\u1ECB"},null,8,["modelValue"])]),_:1}),t(g,{label:"Lo\u1EA1i t\xE0i kho\u1EA3n"},{default:e(()=>[t(I,{modelValue:_.role,"onUpdate:modelValue":l[6]||(l[6]=a=>_.role=a),placeholder:"Lo\u1EA1i t\xE0i kho\u1EA3n"},{default:e(()=>[t(F,{label:"Qu\u1EA3n tr\u1ECB vi\xEAn",value:1}),t(F,{label:"C\u1ED9ng t\xE1c vi\xEAn",value:2}),t(F,{label:"Gi\xE1o vi\xEAn ho\u1EB7c \u0111\u1ED1i t\xE1c",value:0})]),_:1},8,["modelValue"])]),_:1}),t(N,null,{default:e(()=>[t(Q,{"auto-upload":!1,onChange:l[7]||(l[7]=a=>{b(a)}),style:{width:"max-content"}},{file:e(({file:a})=>[Ae]),default:e(()=>[t(B,{size:100},{default:e(()=>[D.value?(n(),S("img",{key:0,src:D.value},null,8,be)):(n(),p(u,{key:1,icon:["fas","user"],size:"2x"}))]),_:1})]),_:1})]),_:1}),t(N,{class:"mt-2"},{default:e(()=>[(n(!0),S(J,null,le(f.value,a=>(n(),p(Y,{key:a,class:"ml-1",closable:"","disable-transitions":!1,onClose:_e=>w(a)},{default:e(()=>[c(P(a),1)]),_:2},1032,["onClose"]))),128)),$.value?(n(),p(A,{key:0,ref_key:"InputRef",ref:z,modelValue:i.value,"onUpdate:modelValue":l[8]||(l[8]=a=>i.value=a),class:"ml-1 w-20",size:"small",onKeyup:G(C,["enter"]),onBlur:C},null,8,["modelValue","onKeyup"])):(n(),p(O,{key:1,class:"button-new-tag ml-1",size:"small",onClick:x},{default:e(()=>[Ve]),_:1}))]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}}),Re=["src"],$e=["src"],De=K("span",null,null,-1),Be=c(" + New Tag "),Te=c("H\u1EE7y"),ze=c("C\u1EADp nh\u1EADt"),Le=W({__name:"Edit",props:["modelValue","user"],emits:["update:modelValue","reload"],setup(q,{emit:h}){const R=q,{user:d}=ue(R);se(d,o=>{v.username=o.username,v.name=o.name,v.role=o.role,f.value=o.tags,console.log(o)});const E=H({get(){return R.modelValue},set(o){h("update:modelValue",o)}}),_=m(),v=X({username:d==null?void 0:d.value.username,password:"",name:d==null?void 0:d.value.name,role:d==null?void 0:d.value.role}),T=X({name:re,role:ie,username:de,password:me.splice(0,1)});function U(o){!o||o.validate(l=>{if(l)k();else return oe("T\u1EA1o t\xE0i kho\u1EA3n kh\xF4ng th\xE0nh c\xF4ng!"),!1})}const k=()=>{r.value=!0,j(pe,[d.value.id,v.username,v.password,v.name,L.value,v.role,f.value],{done(){E.value=!1,y(_.value),L.value=!1,D.value=!1,f.value=[]},all(){r.value=!1,h("reload")}})},i=m(""),f=m(d==null?void 0:d.value.tags),$=m(!1),z=m(),w=o=>{f.value.splice(f.value.indexOf(o),1)},x=()=>{$.value=!0,ne(()=>{z.value.input.focus()})},C=()=>{i.value&&f.value.indexOf(i.value)===-1&&f.value.push(i.value),$.value=!1,i.value=""},L=m(!1),D=m(!1),b=o=>{L.value=o,D.value=URL.createObjectURL(o.raw)},r=m(!1),y=o=>{!o||o.resetFields()};return(o,l)=>{const A=s("el-input"),g=s("el-form-item"),F=s("el-option"),I=s("el-select"),u=s("font-awesome-icon"),B=s("el-avatar"),Q=s("el-upload"),N=s("el-row"),Y=s("el-tag"),O=s("el-button"),Z=s("el-form"),ee=s("el-dialog");return n(),p(ee,{modelValue:V(E),"onUpdate:modelValue":l[11]||(l[11]=a=>te(E)?E.value=a:null),title:`S\u1EEDa th\xF4ng tin ng\u01B0\u1EDDi d\xF9ng: ${V(d).name}`},{footer:e(()=>[t(N,{justify:"end"},{default:e(()=>[t(O,{onClick:l[9]||(l[9]=a=>E.value=!1)},{default:e(()=>[Te]),_:1}),t(O,{type:"primary",onClick:l[10]||(l[10]=a=>U(_.value))},{default:e(()=>[ze]),_:1})]),_:1})]),default:e(()=>[t(Z,{ref_key:"RefFormUserEdit",ref:_,model:v,rules:T},{default:e(()=>[t(g,{label:"T\xE0i kho\u1EA3n",prop:"username"},{default:e(()=>[t(A,{modelValue:v.username,"onUpdate:modelValue":l[0]||(l[0]=a=>v.username=a),onKeyup:l[1]||(l[1]=G(a=>U(_.value),["enter"])),placeholder:"T\xE0i kho\u1EA3n"},null,8,["modelValue"])]),_:1}),t(g,{label:"M\u1EADt kh\u1EA9u",prop:"password"},{default:e(()=>[t(A,{modelValue:v.password,"onUpdate:modelValue":l[2]||(l[2]=a=>v.password=a),onKeyup:l[3]||(l[3]=G(a=>U(_.value),["enter"])),placeholder:"M\u1EADt kh\u1EA9u \u0111\u1EC3 tr\xF4ng \u0111\u1EC3 kh\xF4ng \u0111\u1ED5i",type:"password"},null,8,["modelValue"])]),_:1}),t(g,{label:"T\xEAn hi\u1EC3n th\u1ECB",prop:"name"},{default:e(()=>[t(A,{modelValue:v.name,"onUpdate:modelValue":l[4]||(l[4]=a=>v.name=a),onKeyup:l[5]||(l[5]=G(a=>U(_.value),["enter"])),placeholder:"T\xEAn hi\u1EC3n th\u1ECB"},null,8,["modelValue"])]),_:1}),t(g,{label:"Lo\u1EA1i t\xE0i kho\u1EA3n"},{default:e(()=>[t(I,{modelValue:v.role,"onUpdate:modelValue":l[6]||(l[6]=a=>v.role=a),placeholder:"Lo\u1EA1i t\xE0i kho\u1EA3n"},{default:e(()=>[t(F,{label:"Qu\u1EA3n tr\u1ECB vi\xEAn",value:1}),t(F,{label:"C\u1ED9ng t\xE1c vi\xEAn",value:2}),t(F,{label:"Gi\xE1o vi\xEAn ho\u1EB7c \u0111\u1ED1i t\xE1c",value:0})]),_:1},8,["modelValue"])]),_:1}),t(N,null,{default:e(()=>[t(Q,{"auto-upload":!1,onChange:l[7]||(l[7]=a=>{b(a)}),style:{width:"max-content"}},{file:e(({file:a})=>[De]),default:e(()=>[t(B,{size:100},{default:e(()=>[D.value?(n(),S("img",{key:0,src:D.value},null,8,Re)):V(d).avatar?(n(),S("img",{key:1,src:V(d).avatar},null,8,$e)):(n(),p(u,{key:2,icon:["fas","user"],size:"2x"}))]),_:1})]),_:1})]),_:1}),t(N,{class:"mt-2"},{default:e(()=>[(n(!0),S(J,null,le(f.value,a=>(n(),p(Y,{key:a,class:"ml-1",closable:"","disable-transitions":!1,onClose:_e=>w(a)},{default:e(()=>[c(P(a),1)]),_:2},1032,["onClose"]))),128)),$.value?(n(),p(A,{key:0,ref_key:"InputRef",ref:z,modelValue:i.value,"onUpdate:modelValue":l[8]||(l[8]=a=>i.value=a),class:"ml-1 w-20",size:"small",onKeyup:G(C,["enter"]),onBlur:C},null,8,["modelValue","onKeyup"])):(n(),p(O,{key:1,class:"button-new-tag ml-1",size:"small",onClick:x},{default:e(()=>[Be]),_:1}))]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),Se=c("H\u1EE7y"),Ke=c("Thay \u0111\u1ED5i"),Ie=W({__name:"Role",props:["modelValue","userId","userRole","listRole"],emits:["update:modelValue","reload"],setup(q,{emit:h}){const R=q,{userRole:d}=ue(R),E=H({get(){return R.modelValue},set(k){h("update:modelValue",k)}}),_=m(),v=H(()=>{let k=-1,i={},f={},$=R.listRole.map(w=>{k++;let x={id:k,label:w.label,children:w.children.map(C=>(k++,i[C.id]=k,f[k]=C.id,{id:k,label:C.label}))};return x.children.length===0&&(x.disabled=!0),x}),z=d.value.map(w=>{var x;return(x=i[w])!=null?x:-1}).filter(w=>w!==-1);return{list_role:$,link_role:i,link_session:f,role_default:z}});se(d,()=>{_.value&&_.value.setCheckedKeys(v.value.role_default,!1)});const T=m(!1);function U(){let k=_.value.getCheckedKeys();k=k.map(i=>{var f;return(f=v.value.link_session[i])!=null?f:-1}).filter(i=>i!==-1),T.value=!0,j(ve,[R.userId,k],{done:()=>{E.value=!1},all:()=>{T.value=!1}})}return(k,i)=>{const f=s("el-button"),$=s("el-row"),z=s("el-dialog");return n(),p(z,{modelValue:V(E),"onUpdate:modelValue":i[2]||(i[2]=w=>te(E)?E.value=w:null),title:"C\u1EA5p quy\u1EC1n ti\u1EBFt h\u1ECDc"},{footer:e(()=>[t($,{justify:"end"},{default:e(()=>[t(f,{onClick:i[0]||(i[0]=w=>E.value=!1)},{default:e(()=>[Se]),_:1}),t(f,{type:"primary",onClick:i[1]||(i[1]=w=>U()),disabled:T.value,loading:T.value},{default:e(()=>[Ke]),_:1},8,["disabled","loading"])]),_:1})]),default:e(()=>[t(V(he),{ref_key:"treeRef",ref:_,data:V(v).list_role,"default-checked-keys":V(v).role_default,"show-checkbox":"","default-expand-all":"","node-key":"id","highlight-current":""},null,8,["data","default-checked-keys"])]),_:1},8,["modelValue"])}}}),je=K("span",null,"Qu\u1EA3n l\xFD t\xE0i kho\u1EA3n ",-1),Ge=c(" Th\xEAm t\xE0i kho\u1EA3n "),Ne=c(" Gi\xE1o tr\xECnh cho kh\xE1ch "),Oe=c(" L\xE0m m\u1EDBi "),qe=["src"],Qe={key:0},Me=c("QTV"),He=c("CTV"),Xe=c("GV"),Je=c("B\xECnh th\u01B0\u1EDDng"),Pe=c("V\xF4 hi\u1EC7u h\xF3a"),We=c("Kh\xF4ng c\xF3 tag"),Ye=c("Gi\xE1o tr\xECnh"),Ze=c(" Gi\xE1o tr\xECnh "),el=c(" S\u1EEDa "),ll=c(" V\xF4 hi\u1EC7u h\xF3a "),tl=c(" K\xEDch ho\u1EA1t "),al=c(" X\xF3a "),ol=K("h3",null,[K("span",null,"Qu\u1EA3n l\xFD t\xE0i kho\u1EA3n")],-1),nl=K("div",null,[K("p",null,"B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp trang n\xE0y")],-1),dl=W({__name:"User",setup(q){const h=ce(),R=m(!1),d=m(!1),E=m(!1),_=m({id:0,usename:"",name:"",role:0,tags:[]}),v=m(!1),T=m([]),U=m([]),k=m([]),i=m([]),f=b=>{E.value=!0,_.value=b},$=b=>{j(ge,[b],{all(){x()}})},z=b=>{j(ke,[b],{all(){x()}})},w=b=>{j(xe,[b],{all(){x()}})},x=()=>{R.value=!0,j(Ee,[],{done(b){T.value=[],U.value=[],b.users.map(r=>{var o,l,A,g,F,I,u,B;r.tags&&r.tags.map(Q=>{U.value.indexOf(Q)===-1&&U.value.push(Q)});let y={id:(o=Number(r.id))!=null?o:0,username:(l=String(r.username))!=null?l:"",name:(A=String(r.name))!=null?A:"",avatar:(g=String(r.avatar))!=null?g:"",status:(F=Number(r.status))!=null?F:0,role:(I=Number(r.role))!=null?I:0,is_online:(u=Number(r.is_online))!=null?u:0,tags:(B=r.tags)!=null?B:[]};T.value.push(y)})},all(){R.value=!1}})};(h.login&&Ce.exports.indexOf([1,2],h.info.role))!=-1&&x();const C=m(0),L=m(0);function D(b){C.value=b,L.value=b,j(ye,[b],{done:r=>{let y=[];r.user_role&&r.user_role.map(l=>{y.push(Number(l))}),k.value=y;let o=[];r.list_role&&r.list_role.map(l=>{let A=[];l.sessions&&l.sessions.map(g=>{A.push({id:Number(g.id),label:String(g.name)})}),o.push({label:String(l.name),children:A})}),i.value=o,v.value=!0},all(){C.value=0}})}return(b,r)=>{const y=s("el-button"),o=s("el-row"),l=s("font-awesome-icon"),A=s("el-avatar"),g=s("el-tag"),F=s("el-table-column"),I=s("el-table");return V(h).login&&(V(h).info.role===1||V(h).info.role===2)?(n(),p(ae,{key:0},{default:e(()=>[t(o,{align:"middle",justify:"space-between"},{default:e(()=>[K("h3",null,[je,V(h).info.role===1?(n(),p(y,{key:0,size:"small",type:"primary",onClick:r[0]||(r[0]=u=>d.value=!0)},{default:e(()=>[Ge]),_:1})):M("",!0),t(y,{size:"small",type:"primary",onClick:r[1]||(r[1]=u=>D(0)),disabled:!!C.value,loading:C.value?C.value===0:!1},{default:e(()=>[Ne]),_:1},8,["disabled","loading"])]),t(y,{size:"small",type:"primary",onClick:x,disabled:R.value,loading:R.value},{default:e(()=>[Oe]),_:1},8,["disabled","loading"])]),_:1}),t(I,{data:T.value,style:{width:"100%"}},{default:e(()=>[t(F,{label:"T\xE0i kho\u1EA3n","table-layout":"auto"},{default:e(u=>[t(o,{align:"middle"},{default:e(()=>[t(A,{size:30,class:"mr-1"},{default:e(()=>[u.row.avatar?(n(),S("img",{key:0,src:u.row.avatar},null,8,qe)):(n(),p(l,{key:1,icon:["fas","user"]}))]),_:2},1024),K("span",null,P(u.row.username),1),u.row.id===V(h).info.id?(n(),S("b",Qe," (T\xF4i)")):M("",!0),u.row.role===1?(n(),p(g,{key:1,class:"ml-2",title:"Qu\u1EA3n tr\u1ECB vi\xEAn ho\u1EB7c qu\u1EA3n l\xFD"},{default:e(()=>[Me]),_:1})):u.row.role===2?(n(),p(g,{key:2,class:"ml-2",title:"C\u1ED9ng t\xE1c vi\xEAn ho\u1EB7c bi\xEAn t\u1EADp vi\xEAn"},{default:e(()=>[He]),_:1})):(n(),p(g,{key:3,class:"ml-2",title:"Gi\xE1o vi\xEAn ho\u1EB7c \u0111\u1ED1i t\xE1c"},{default:e(()=>[Xe]),_:1})),u.row.status?(n(),p(g,{key:4,class:"ml-2",type:"success"},{default:e(()=>[Je]),_:1})):(n(),p(g,{key:5,class:"ml-2",type:"danger"},{default:e(()=>[Pe]),_:1}))]),_:2},1024)]),_:1}),t(F,{label:"H\u1ECD t\xEAn",prop:"name"}),t(F,{label:"Tag"},{default:e(u=>[u.row.tags.length>0?(n(!0),S(J,{key:0},le(u.row.tags,B=>(n(),p(g,{class:"ml-2",type:"info"},{default:e(()=>[c(P(B),1)]),_:2},1024))),256)):(n(),p(g,{key:1,class:"ml-2",type:"info"},{default:e(()=>[We]),_:1}))]),_:1}),t(F,{label:"Ch\u1EE9c n\u0103ng",align:"right"},{default:e(u=>[u.row.role===1?(n(),p(y,{key:0,size:"small",type:"primary",title:"Qu\u1EA3n tr\u1ECB vi\xEAn kh\xF4ng c\u1EA7n \u0111\u1EB7t quy\u1EC1n",disabled:""},{default:e(()=>[Ye]),_:1})):(n(),p(y,{key:1,size:"small",type:"primary",onClick:B=>D(u.row.id),disabled:!!C.value,loading:C.value?C.value===u.row.id:!1},{default:e(()=>[Ze]),_:2},1032,["onClick","disabled","loading"])),V(h).info.role===1?(n(),S(J,{key:2},[V(h).info.role===1?(n(),p(y,{key:0,onClick:B=>f(u.row),size:"small"},{default:e(()=>[el]),_:2},1032,["onClick"])):M("",!0),u.row.status?(n(),p(y,{key:1,onClick:B=>w(u.row.id),size:"small",type:"danger"},{default:e(()=>[ll]),_:2},1032,["onClick"])):(n(),p(y,{key:2,onClick:B=>z(u.row.id),size:"small",type:"success"},{default:e(()=>[tl]),_:2},1032,["onClick"])),V(h).info.role===1?(n(),p(y,{key:3,onClick:B=>$(u.row.id),class:"ml-2",size:"small",type:"danger"},{default:e(()=>[al]),_:2},1032,["onClick"])):M("",!0)],64)):M("",!0)]),_:1})]),_:1},8,["data"]),t(Fe,{modelValue:d.value,"onUpdate:modelValue":r[2]||(r[2]=u=>d.value=u),onReload:x},null,8,["modelValue"]),t(Le,{modelValue:E.value,"onUpdate:modelValue":r[3]||(r[3]=u=>E.value=u),user:_.value,onReload:x},null,8,["modelValue","user"]),t(Ie,{modelValue:v.value,"onUpdate:modelValue":r[4]||(r[4]=u=>v.value=u),userId:L.value,userRole:k.value,listRole:i.value,onReload:x},null,8,["modelValue","userId","userRole","listRole"])]),_:1})):(n(),p(ae,{key:1},{default:e(()=>[t(o,{align:"middle",justify:"space-between"},{default:e(()=>[ol]),_:1}),t(o,null,{default:e(()=>[nl]),_:1})]),_:1}))}}});export{dl as default};
