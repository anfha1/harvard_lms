import{a as te,f as N,m as ae,d as oe,u as ne,L as se,e as ue,g as re}from"./Basic.f61f3584.js";import{d as O,v as j,i as _,z as Q,o as r,c as p,w as e,a as l,A as L,b as $,h as M,F as X,u as T,x as J,e as K,l as f,B as ie,r as m,f as q,t as de,C as me,D as _e,j as H}from"./index.5794a6b1.js";import{n as fe,r as pe,u as ce,p as ve}from"./rules.855a92c6.js";import{l as Ee}from"./lodash.c1d5bc85.js";const ge=["src"],he=K("span",null,null,-1),xe=f(" + New Tag "),ye=f("H\u1EE7y"),ke=f("T\u1EA1o t\xE0i kho\u1EA3n"),be=O({__name:"Create",props:["modelValue"],emits:["update:modelValue","reload"],setup(S,{emit:w}){const C=S,y=j({get(){return C.modelValue},set(o){w("update:modelValue",o)}}),v=_(),i=Q({username:"",password:"",name:"",role:0}),V=Q({name:fe,role:pe,username:ce,password:ve});function k(o){!o||o.validate(t=>{if(t)F();else return te("T\u1EA1o t\xE0i kho\u1EA3n kh\xF4ng th\xE0nh c\xF4ng!"),!1})}const F=()=>{x.value=!0,N(ae,[i.username,i.password,i.name,a.value.raw,i.role,s.value],{done(){y.value=!1,U(v.value),a.value=!1,g.value=!1,s.value=[]},all(){x.value=!1,w("reload")}})},d=_(""),s=_([]),c=_(!1),b=_(),D=o=>{s.value.splice(s.value.indexOf(o),1)},h=()=>{c.value=!0,ie(()=>{b.value.input.focus()})},E=()=>{d.value&&s.value.indexOf(d.value)===-1&&s.value.push(d.value),c.value=!1,d.value=""},a=_(!1),g=_(!1),A=o=>{a.value=o,g.value=URL.createObjectURL(o.raw)},x=_(!1),U=o=>{!o||o.resetFields()};return(o,t)=>{const R=m("el-input"),n=m("el-form-item"),B=m("el-option"),z=m("el-select"),P=m("font-awesome-icon"),W=m("el-avatar"),Y=m("el-upload"),I=m("el-row"),Z=m("el-tag"),G=m("el-button"),ee=m("el-form"),le=m("el-dialog");return r(),p(le,{modelValue:T(y),"onUpdate:modelValue":t[11]||(t[11]=u=>J(y)?y.value=u:null),title:"Th\xEAm ng\u01B0\u1EDDi d\xF9ng m\u1EDBi"},{footer:e(()=>[l(I,{justify:"end"},{default:e(()=>[l(G,{onClick:t[9]||(t[9]=u=>y.value=!1)},{default:e(()=>[ye]),_:1}),l(G,{type:"primary",onClick:t[10]||(t[10]=u=>k(v.value))},{default:e(()=>[ke]),_:1})]),_:1})]),default:e(()=>[l(ee,{ref_key:"formRefUserCreate",ref:v,model:i,rules:V},{default:e(()=>[l(n,{label:"T\xE0i kho\u1EA3n",prop:"username"},{default:e(()=>[l(R,{modelValue:i.username,"onUpdate:modelValue":t[0]||(t[0]=u=>i.username=u),onKeyup:t[1]||(t[1]=L(u=>k(v.value),["enter"])),placeholder:"T\xE0i kho\u1EA3n"},null,8,["modelValue"])]),_:1}),l(n,{label:"M\u1EADt kh\u1EA9u",prop:"password"},{default:e(()=>[l(R,{modelValue:i.password,"onUpdate:modelValue":t[2]||(t[2]=u=>i.password=u),onKeyup:t[3]||(t[3]=L(u=>k(v.value),["enter"])),placeholder:"M\u1EADt kh\u1EA9u",type:"password"},null,8,["modelValue"])]),_:1}),l(n,{label:"T\xEAn hi\u1EC3n th\u1ECB",prop:"name"},{default:e(()=>[l(R,{modelValue:i.name,"onUpdate:modelValue":t[4]||(t[4]=u=>i.name=u),onKeyup:t[5]||(t[5]=L(u=>k(v.value),["enter"])),placeholder:"T\xEAn hi\u1EC3n th\u1ECB"},null,8,["modelValue"])]),_:1}),l(n,{label:"Lo\u1EA1i t\xE0i kho\u1EA3n"},{default:e(()=>[l(z,{modelValue:i.role,"onUpdate:modelValue":t[6]||(t[6]=u=>i.role=u),placeholder:"Lo\u1EA1i t\xE0i kho\u1EA3n"},{default:e(()=>[l(B,{label:"Qu\u1EA3n tr\u1ECB vi\xEAn",value:1}),l(B,{label:"C\u1ED9ng t\xE1c vi\xEAn",value:2}),l(B,{label:"Gi\xE1o vi\xEAn ho\u1EB7c \u0111\u1ED1i t\xE1c",value:0})]),_:1},8,["modelValue"])]),_:1}),l(I,null,{default:e(()=>[l(Y,{"auto-upload":!1,onChange:t[7]||(t[7]=u=>{A(u)}),style:{width:"max-content"}},{file:e(({file:u})=>[he]),default:e(()=>[l(W,{size:100},{default:e(()=>[g.value?(r(),$("img",{key:0,src:g.value},null,8,ge)):(r(),p(P,{key:1,icon:["fas","user"],size:"2x"}))]),_:1})]),_:1})]),_:1}),l(I,{class:"mt-2"},{default:e(()=>[(r(!0),$(X,null,M(s.value,u=>(r(),p(Z,{key:u,class:"ml-1",closable:"","disable-transitions":!1,onClose:je=>D(u)},{default:e(()=>[f(q(u),1)]),_:2},1032,["onClose"]))),128)),c.value?(r(),p(R,{key:0,ref_key:"InputRef",ref:b,modelValue:d.value,"onUpdate:modelValue":t[8]||(t[8]=u=>d.value=u),class:"ml-1 w-20",size:"small",onKeyup:L(E,["enter"]),onBlur:E},null,8,["modelValue","onKeyup"])):(r(),p(G,{key:1,class:"button-new-tag ml-1",size:"small",onClick:h},{default:e(()=>[xe]),_:1}))]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}}),Ce=f("H\u1EE7y"),we=f("Thay \u0111\u1ED5i"),Ve=O({__name:"Role",props:["modelValue","userId","userRole","listRole"],emits:["update:modelValue","reload"],setup(S,{emit:w}){const C=S,{userRole:y}=de(C),v=j({get(){return C.modelValue},set(d){w("update:modelValue",d)}}),i=_(),V=j(()=>{let d=-1,s={},c={},b=C.listRole.map(h=>{d++;let E={id:d,label:h.label,children:h.children.map(a=>(d++,s[a.id]=d,c[d]=a.id,{id:d,label:a.label}))};return E.children.length===0&&(E.disabled=!0),E}),D=y.value.map(h=>{var E;return(E=s[h])!=null?E:-1}).filter(h=>h!==-1);return{list_role:b,link_role:s,link_session:c,role_default:D}});me(y,()=>{i.value&&i.value.setCheckedKeys(V.value.role_default,!1)});const k=_(!1);function F(){let d=i.value.getCheckedKeys();d=d.map(s=>{var c;return(c=V.value.link_session[s])!=null?c:-1}).filter(s=>s!==-1),k.value=!0,N(oe,[C.userId,d],{done:()=>{v.value=!1},all:()=>{k.value=!1}})}return(d,s)=>{const c=m("el-button"),b=m("el-row"),D=m("el-dialog");return r(),p(D,{modelValue:T(v),"onUpdate:modelValue":s[2]||(s[2]=h=>J(v)?v.value=h:null),title:"C\u1EA5p quy\u1EC1n ti\u1EBFt h\u1ECDc"},{footer:e(()=>[l(b,{justify:"end"},{default:e(()=>[l(c,{onClick:s[0]||(s[0]=h=>v.value=!1)},{default:e(()=>[Ce]),_:1}),l(c,{type:"primary",onClick:s[1]||(s[1]=h=>F()),disabled:k.value,loading:k.value},{default:e(()=>[we]),_:1},8,["disabled","loading"])]),_:1})]),default:e(()=>[l(T(_e),{ref_key:"treeRef",ref:i,data:T(V).list_role,"default-checked-keys":T(V).role_default,"show-checkbox":"","default-expand-all":"","node-key":"id","highlight-current":""},null,8,["data","default-checked-keys"])]),_:1},8,["modelValue"])}}}),Ae=K("span",null,"Qu\u1EA3n l\xFD t\xE0i kho\u1EA3n ",-1),Ue=f(" Th\xEAm t\xE0i kho\u1EA3n "),Re=f(" L\xE0m m\u1EDBi "),Be=["src"],De={key:0},Te=f("QTV"),Fe=f("CTV"),$e=f("GV"),Se=f("B\xECnh th\u01B0\u1EDDng"),ze=f("V\xF4 hi\u1EC7u h\xF3a"),Le=f("Kh\xF4ng c\xF3 tag"),Ne=f("Gi\xE1o tr\xECnh"),Ke=f(" Gi\xE1o tr\xECnh "),Ie=f(" S\u1EEDa "),Ge=f(" X\xF3a "),Me=O({__name:"User",setup(S){const w=ne(),C=_(!1),y=_(!1),v=_(!1),i=_([]),V=_([]),k=_([]),F=_([]),d=()=>{console.log(2)},s=()=>{console.log(2)},c=()=>{C.value=!0,N(ue,[],{done(E){i.value=[],V.value=[],E.users.map(a=>{var A,x,U,o,t,R,n,B;a.tags&&a.tags.map(z=>{V.value.indexOf(z)===-1&&V.value.push(z)});let g={id:(A=Number(a.id))!=null?A:0,username:(x=String(a.username))!=null?x:"",name:(U=String(a.name))!=null?U:"",avatar:(o=String(a.avatar))!=null?o:"",status:(t=Number(a.status))!=null?t:0,role:(R=Number(a.role))!=null?R:0,is_online:(n=Number(a.is_online))!=null?n:0,tags:(B=a.tags)!=null?B:[]};i.value.push(g)})},all(){C.value=!1}})};(w.login&&Ee.exports.indexOf([1,2],w.info.role))!=-1&&c();const b=_(0),D=_(0);function h(E){b.value=E,D.value=E,N(re,[E],{done:a=>{let g=[];a.user_role&&a.user_role.map(x=>{g.push(Number(x))}),k.value=g;let A=[];a.list_role&&a.list_role.map(x=>{let U=[];x.sessions&&x.sessions.map(o=>{U.push({id:Number(o.id),label:String(o.name)})}),A.push({label:String(x.name),children:U})}),F.value=A,v.value=!0},all(){b.value=0}})}return(E,a)=>{const g=m("el-button"),A=m("el-row"),x=m("font-awesome-icon"),U=m("el-avatar"),o=m("el-tag"),t=m("el-table-column"),R=m("el-table");return r(),p(se,null,{default:e(()=>[l(A,{align:"middle",justify:"space-between"},{default:e(()=>[K("h3",null,[Ae,T(w).login&&T(w).info.role===1?(r(),p(g,{key:0,size:"small",type:"primary",onClick:a[0]||(a[0]=n=>y.value=!0)},{default:e(()=>[Ue]),_:1})):H("",!0)]),l(g,{size:"small",type:"primary",onClick:c,disabled:C.value,loading:C.value},{default:e(()=>[Re]),_:1},8,["disabled","loading"])]),_:1}),l(R,{data:i.value,style:{width:"100%"}},{default:e(()=>[l(t,{label:"T\xE0i kho\u1EA3n","table-layout":"auto"},{default:e(n=>[l(A,{align:"middle"},{default:e(()=>[l(U,{size:30,class:"mr-1"},{default:e(()=>[n.row.avatar?(r(),$("img",{key:0,src:n.row.avatar},null,8,Be)):(r(),p(x,{key:1,icon:["fas","user"]}))]),_:2},1024),K("span",null,q(n.row.username),1),n.row.id===T(w).info.id?(r(),$("b",De," (T\xF4i)")):H("",!0),n.row.role===1?(r(),p(o,{key:1,class:"ml-2",title:"Qu\u1EA3n tr\u1ECB vi\xEAn ho\u1EB7c qu\u1EA3n l\xFD"},{default:e(()=>[Te]),_:1})):n.row.role===2?(r(),p(o,{key:2,class:"ml-2",title:"C\u1ED9ng t\xE1c vi\xEAn ho\u1EB7c bi\xEAn t\u1EADp vi\xEAn"},{default:e(()=>[Fe]),_:1})):(r(),p(o,{key:3,class:"ml-2",title:"Gi\xE1o vi\xEAn ho\u1EB7c \u0111\u1ED1i t\xE1c"},{default:e(()=>[$e]),_:1})),n.row.status?(r(),p(o,{key:4,class:"ml-2",type:"success"},{default:e(()=>[Se]),_:1})):(r(),p(o,{key:5,class:"ml-2",type:"danger"},{default:e(()=>[ze]),_:1}))]),_:2},1024)]),_:1}),l(t,{label:"H\u1ECD t\xEAn",prop:"name"}),l(t,{label:"Tag"},{default:e(n=>[n.row.tags.length>0?(r(!0),$(X,{key:0},M(n.row.tags,B=>(r(),p(o,{class:"ml-2",type:"info"},{default:e(()=>[f(q(B),1)]),_:2},1024))),256)):(r(),p(o,{key:1,class:"ml-2",type:"info"},{default:e(()=>[Le]),_:1}))]),_:1}),l(t,{label:"Ch\u1EE9c n\u0103ng",align:"right"},{default:e(n=>[n.row.role===1?(r(),p(g,{key:0,size:"small",type:"primary",title:"Qu\u1EA3n tr\u1ECB vi\xEAn kh\xF4ng c\u1EA7n \u0111\u1EB7t quy\u1EC1n",disabled:""},{default:e(()=>[Ne]),_:1})):(r(),p(g,{key:1,size:"small",type:"primary",onClick:B=>h(n.row.id),disabled:!!b.value,loading:b.value?b.value===n.row.id:!1},{default:e(()=>[Ke]),_:2},1032,["onClick","disabled","loading"])),l(g,{size:"small",onClick:d},{default:e(()=>[Ie]),_:1}),l(g,{size:"small",type:"danger",onClick:s},{default:e(()=>[Ge]),_:1})]),_:1})]),_:1},8,["data"]),l(be,{modelValue:y.value,"onUpdate:modelValue":a[1]||(a[1]=n=>y.value=n),onReload:c},null,8,["modelValue"]),l(Ve,{modelValue:v.value,"onUpdate:modelValue":a[2]||(a[2]=n=>v.value=n),userId:D.value,userRole:k.value,listRole:F.value,onReload:c},null,8,["modelValue","userId","userRole","listRole"])]),_:1})}}});export{Me as default};
