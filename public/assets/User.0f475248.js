import{a as te,f as N,m as ae,d as oe,u as ne,L as se,e as ue,g as re}from"./Basic.b15737b4.js";import{d as O,v as j,i as _,z as Q,o as i,c as p,w as e,a as l,A as L,b as $,h as M,F as X,u as T,x as J,e as K,l as f,B as ie,r as d,f as q,C as de,j as H}from"./index.75ce82a2.js";import{n as me,r as _e,u as fe,p as pe}from"./rules.855a92c6.js";import{l as ce}from"./lodash.8eb9fa8f.js";const ve=["src"],Ee=K("span",null,null,-1),ge=f(" + New Tag "),he=f("H\u1EE7y"),xe=f("T\u1EA1o t\xE0i kho\u1EA3n"),ye=O({__name:"Create",props:["modelValue"],emits:["update:modelValue","reload"],setup(S,{emit:V}){const C=S,g=j({get(){return C.modelValue},set(o){V("update:modelValue",o)}}),h=_(),m=Q({username:"",password:"",name:"",role:0}),D=Q({name:me,role:_e,username:fe,password:pe});function k(o){!o||o.validate(t=>{if(t)F();else return te("T\u1EA1o t\xE0i kho\u1EA3n kh\xF4ng th\xE0nh c\xF4ng!"),!1})}const F=()=>{y.value=!0,N(ae,[m.username,m.password,m.name,a.value.raw,m.role,u.value],{done(){g.value=!1,U(h.value),a.value=!1,E.value=!1,u.value=[]},all(){y.value=!1,V("reload")}})},s=_(""),u=_([]),c=_(!1),b=_(),A=o=>{u.value.splice(u.value.indexOf(o),1)},x=()=>{c.value=!0,ie(()=>{b.value.input.focus()})},v=()=>{s.value&&u.value.indexOf(s.value)===-1&&u.value.push(s.value),c.value=!1,s.value=""},a=_(!1),E=_(!1),w=o=>{a.value=o,E.value=URL.createObjectURL(o.raw)},y=_(!1),U=o=>{!o||o.resetFields()};return(o,t)=>{const R=d("el-input"),n=d("el-form-item"),B=d("el-option"),z=d("el-select"),P=d("font-awesome-icon"),W=d("el-avatar"),Y=d("el-upload"),I=d("el-row"),Z=d("el-tag"),G=d("el-button"),ee=d("el-form"),le=d("el-dialog");return i(),p(le,{modelValue:T(g),"onUpdate:modelValue":t[11]||(t[11]=r=>J(g)?g.value=r:null),title:"Th\xEAm ng\u01B0\u1EDDi d\xF9ng m\u1EDBi"},{footer:e(()=>[l(I,{justify:"end"},{default:e(()=>[l(G,{onClick:t[9]||(t[9]=r=>g.value=!1)},{default:e(()=>[he]),_:1}),l(G,{type:"primary",onClick:t[10]||(t[10]=r=>k(h.value))},{default:e(()=>[xe]),_:1})]),_:1})]),default:e(()=>[l(ee,{ref_key:"formRefUserCreate",ref:h,model:m,rules:D},{default:e(()=>[l(n,{label:"T\xE0i kho\u1EA3n",prop:"username"},{default:e(()=>[l(R,{modelValue:m.username,"onUpdate:modelValue":t[0]||(t[0]=r=>m.username=r),onKeyup:t[1]||(t[1]=L(r=>k(h.value),["enter"])),placeholder:"T\xE0i kho\u1EA3n"},null,8,["modelValue"])]),_:1}),l(n,{label:"M\u1EADt kh\u1EA9u",prop:"password"},{default:e(()=>[l(R,{modelValue:m.password,"onUpdate:modelValue":t[2]||(t[2]=r=>m.password=r),onKeyup:t[3]||(t[3]=L(r=>k(h.value),["enter"])),placeholder:"M\u1EADt kh\u1EA9u",type:"password"},null,8,["modelValue"])]),_:1}),l(n,{label:"T\xEAn hi\u1EC3n th\u1ECB",prop:"name"},{default:e(()=>[l(R,{modelValue:m.name,"onUpdate:modelValue":t[4]||(t[4]=r=>m.name=r),onKeyup:t[5]||(t[5]=L(r=>k(h.value),["enter"])),placeholder:"T\xEAn hi\u1EC3n th\u1ECB"},null,8,["modelValue"])]),_:1}),l(n,{label:"Lo\u1EA1i t\xE0i kho\u1EA3n"},{default:e(()=>[l(z,{modelValue:m.role,"onUpdate:modelValue":t[6]||(t[6]=r=>m.role=r),placeholder:"Lo\u1EA1i t\xE0i kho\u1EA3n"},{default:e(()=>[l(B,{label:"Qu\u1EA3n tr\u1ECB vi\xEAn",value:1}),l(B,{label:"C\u1ED9ng t\xE1c vi\xEAn",value:2}),l(B,{label:"Gi\xE1o vi\xEAn ho\u1EB7c \u0111\u1ED1i t\xE1c",value:0})]),_:1},8,["modelValue"])]),_:1}),l(I,null,{default:e(()=>[l(Y,{"auto-upload":!1,onChange:t[7]||(t[7]=r=>{w(r)}),style:{width:"max-content"}},{file:e(({file:r})=>[Ee]),default:e(()=>[l(W,{size:100},{default:e(()=>[E.value?(i(),$("img",{key:0,src:E.value},null,8,ve)):(i(),p(P,{key:1,icon:["fas","user"],size:"2x"}))]),_:1})]),_:1})]),_:1}),l(I,{class:"mt-2"},{default:e(()=>[(i(!0),$(X,null,M(u.value,r=>(i(),p(Z,{key:r,class:"ml-1",closable:"","disable-transitions":!1,onClose:Ie=>A(r)},{default:e(()=>[f(q(r),1)]),_:2},1032,["onClose"]))),128)),c.value?(i(),p(R,{key:0,ref_key:"InputRef",ref:b,modelValue:s.value,"onUpdate:modelValue":t[8]||(t[8]=r=>s.value=r),class:"ml-1 w-20",size:"small",onKeyup:L(v,["enter"]),onBlur:v},null,8,["modelValue","onKeyup"])):(i(),p(G,{key:1,class:"button-new-tag ml-1",size:"small",onClick:x},{default:e(()=>[ge]),_:1}))]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}}),ke=f("H\u1EE7y"),be=f("Thay \u0111\u1ED5i"),Ce=O({__name:"Role",props:["modelValue","userId","userRole","listRole"],emits:["update:modelValue","reload"],setup(S,{emit:V}){const C=S,g=j({get(){return C.modelValue},set(s){V("update:modelValue",s)}}),h=_(),m=j(()=>{let s=-1,u={},c={},b=C.listRole.map(x=>{s++;let v={id:s,label:x.label,children:x.children.map(a=>(s++,u[a.id]=s,c[s]=a.id,{id:s,label:a.label}))};return v.children.length===0&&(v.disabled=!0),v}),A=C.userRole.map(x=>{var v;return(v=u[x])!=null?v:-1}).filter(x=>x!==-1);return D(A),{list_role:b,link_role:u,link_session:c,role_default:A}});function D(s){h.value&&h.value.setCheckedKeys(s,!1)}const k=_(!1);function F(){let s=h.value.getCheckedKeys();s=s.map(u=>{var c;return(c=m.value.link_session[u])!=null?c:-1}).filter(u=>u!==-1),k.value=!0,N(oe,[C.userId,s],{done:()=>{g.value=!1},all:()=>{k.value=!1}})}return(s,u)=>{const c=d("el-button"),b=d("el-row"),A=d("el-dialog");return i(),p(A,{modelValue:T(g),"onUpdate:modelValue":u[2]||(u[2]=x=>J(g)?g.value=x:null),title:"C\u1EA5p quy\u1EC1n ti\u1EBFt h\u1ECDc"},{footer:e(()=>[l(b,{justify:"end"},{default:e(()=>[l(c,{onClick:u[0]||(u[0]=x=>g.value=!1)},{default:e(()=>[ke]),_:1}),l(c,{type:"primary",onClick:u[1]||(u[1]=x=>F()),disabled:k.value,loading:k.value},{default:e(()=>[be]),_:1},8,["disabled","loading"])]),_:1})]),default:e(()=>[l(T(de),{ref_key:"treeRef",ref:h,data:T(m).list_role,"default-checked-keys":T(m).role_default,"show-checkbox":"","default-expand-all":"","node-key":"id","highlight-current":""},null,8,["data","default-checked-keys"])]),_:1},8,["modelValue"])}}}),Ve=K("span",null,"Qu\u1EA3n l\xFD t\xE0i kho\u1EA3n ",-1),we=f(" Th\xEAm t\xE0i kho\u1EA3n "),Ae=f(" L\xE0m m\u1EDBi "),Ue=["src"],Re={key:0},Be=f("QTV"),Te=f("CTV"),De=f("GV"),Fe=f("B\xECnh th\u01B0\u1EDDng"),$e=f("V\xF4 hi\u1EC7u h\xF3a"),Se=f("Kh\xF4ng c\xF3 tag"),ze=f("Gi\xE1o tr\xECnh"),Le=f(" Gi\xE1o tr\xECnh "),Ne=f(" S\u1EEDa "),Ke=f(" X\xF3a "),Qe=O({__name:"User",setup(S){const V=ne(),C=_(!1),g=_(!1),h=_(!1),m=_([]),D=_([]),k=_([]),F=_([]),s=()=>{console.log(2)},u=()=>{console.log(2)},c=()=>{C.value=!0,N(ue,[],{done(v){m.value=[],D.value=[],v.users.map(a=>{var w,y,U,o,t,R,n,B;a.tags&&a.tags.map(z=>{D.value.indexOf(z)===-1&&D.value.push(z)});let E={id:(w=Number(a.id))!=null?w:0,username:(y=String(a.username))!=null?y:"",name:(U=String(a.name))!=null?U:"",avatar:(o=String(a.avatar))!=null?o:"",status:(t=Number(a.status))!=null?t:0,role:(R=Number(a.role))!=null?R:0,is_online:(n=Number(a.is_online))!=null?n:0,tags:(B=a.tags)!=null?B:[]};m.value.push(E)})},all(){C.value=!1}})};(V.login&&ce.exports.indexOf([1,2],V.info.role))!=-1&&c();const b=_(0),A=_(0);function x(v){b.value=v,A.value=v,N(re,[v],{done:a=>{let E=[];a.user_role&&a.user_role.map(y=>{E.push(Number(y))}),k.value=E;let w=[];a.list_role&&a.list_role.map(y=>{let U=[];y.sessions&&y.sessions.map(o=>{U.push({id:Number(o.id),label:String(o.name)})}),w.push({label:String(y.name),children:U})}),F.value=w,h.value=!0},all(){b.value=0}})}return(v,a)=>{const E=d("el-button"),w=d("el-row"),y=d("font-awesome-icon"),U=d("el-avatar"),o=d("el-tag"),t=d("el-table-column"),R=d("el-table");return i(),p(se,null,{default:e(()=>[l(w,{align:"middle",justify:"space-between"},{default:e(()=>[K("h3",null,[Ve,T(V).login&&T(V).info.role===1?(i(),p(E,{key:0,size:"small",type:"primary",onClick:a[0]||(a[0]=n=>g.value=!0)},{default:e(()=>[we]),_:1})):H("",!0)]),l(E,{size:"small",type:"primary",onClick:c,disabled:C.value,loading:C.value},{default:e(()=>[Ae]),_:1},8,["disabled","loading"])]),_:1}),l(R,{data:m.value,style:{width:"100%"}},{default:e(()=>[l(t,{label:"T\xE0i kho\u1EA3n","table-layout":"auto"},{default:e(n=>[l(w,{align:"middle"},{default:e(()=>[l(U,{size:30,class:"mr-1"},{default:e(()=>[n.row.avatar?(i(),$("img",{key:0,src:n.row.avatar},null,8,Ue)):(i(),p(y,{key:1,icon:["fas","user"]}))]),_:2},1024),K("span",null,q(n.row.username),1),n.row.id===T(V).info.id?(i(),$("b",Re," (T\xF4i)")):H("",!0),n.row.role===1?(i(),p(o,{key:1,class:"ml-2",title:"Qu\u1EA3n tr\u1ECB vi\xEAn ho\u1EB7c qu\u1EA3n l\xFD"},{default:e(()=>[Be]),_:1})):n.row.role===2?(i(),p(o,{key:2,class:"ml-2",title:"C\u1ED9ng t\xE1c vi\xEAn ho\u1EB7c bi\xEAn t\u1EADp vi\xEAn"},{default:e(()=>[Te]),_:1})):(i(),p(o,{key:3,class:"ml-2",title:"Gi\xE1o vi\xEAn ho\u1EB7c \u0111\u1ED1i t\xE1c"},{default:e(()=>[De]),_:1})),n.row.status?(i(),p(o,{key:4,class:"ml-2",type:"success"},{default:e(()=>[Fe]),_:1})):(i(),p(o,{key:5,class:"ml-2",type:"danger"},{default:e(()=>[$e]),_:1}))]),_:2},1024)]),_:1}),l(t,{label:"H\u1ECD t\xEAn",prop:"name"}),l(t,{label:"Tag"},{default:e(n=>[n.row.tags.length>0?(i(!0),$(X,{key:0},M(n.row.tags,B=>(i(),p(o,{class:"ml-2",type:"info"},{default:e(()=>[f(q(B),1)]),_:2},1024))),256)):(i(),p(o,{key:1,class:"ml-2",type:"info"},{default:e(()=>[Se]),_:1}))]),_:1}),l(t,{label:"Ch\u1EE9c n\u0103ng",align:"right"},{default:e(n=>[n.row.role===1?(i(),p(E,{key:0,size:"small",type:"primary",title:"Qu\u1EA3n tr\u1ECB vi\xEAn kh\xF4ng c\u1EA7n \u0111\u1EB7t quy\u1EC1n",disabled:""},{default:e(()=>[ze]),_:1})):(i(),p(E,{key:1,size:"small",type:"primary",onClick:B=>x(n.row.id),disabled:!!b.value,loading:b.value?b.value===n.row.id:!1},{default:e(()=>[Le]),_:2},1032,["onClick","disabled","loading"])),l(E,{size:"small",onClick:s},{default:e(()=>[Ne]),_:1}),l(E,{size:"small",type:"danger",onClick:u},{default:e(()=>[Ke]),_:1})]),_:1})]),_:1},8,["data"]),l(ye,{modelValue:g.value,"onUpdate:modelValue":a[1]||(a[1]=n=>g.value=n),onReload:c},null,8,["modelValue"]),l(Ce,{modelValue:h.value,"onUpdate:modelValue":a[2]||(a[2]=n=>h.value=n),userId:A.value,userRole:k.value,listRole:F.value,onReload:c},null,8,["modelValue","userId","userRole","listRole"])]),_:1})}}});export{Qe as default};
